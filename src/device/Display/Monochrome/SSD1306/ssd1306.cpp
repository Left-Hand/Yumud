#include "ssd1306.hpp"


void SSD1306::init(){    
    static const uint8_t initCmds[] = { 
        0xAE, 0xD5, 0x80, 0xA8, 0x3F, 0xD3, 0x00, 0x40, 0xA1, 0xC8, 0xDA, 0x12, 0x81, 0xCF, 0xD9, 0xF1, 0xDB, 0x30, 0xA4, 0xA6, 0x8D, 0x14, 0xAF
    };
    // static const uint8_t initCmds[] = { 
        // 0xAE, 0xD5, 0xf0, 0xa8, 0x27, 0xd3, 0x00, 0x40, 0x8d, 0x14, 0x20, 0x02, 0xa1, 0xc8, 0xda, 0x12, 0xad, 0x30, 0x81, 0xff, 0xd9, 0x22, 0xdb, 0x20, 0xa4, 0xa6, 0x0c, 0x11, 0xaf
    // };

    for(auto & cmd:initCmds){
        interface.writeCommand(cmd);
    }
}


void SSD1306::flush(const Binary & color){
    volatile static uint8_t t = 0;
    for(uint8_t y = 0; y < height; y+=8)  {  
        setPos(0,y);
        interface.writePool(y + (t++), (size_t)width);
        t++;
    }
}