这段笔记描述了通过 **牛顿-拉夫逊方法**（Newton-Raphson method）计算**逆平方根** \( 1/\sqrt{x} \) 的推导过程。

## 1. 问题与目标
要计算：
\[
\frac{1}{\sqrt{x}}
\]
等价于寻找一个数 \( g \)，使得：
\[
g = \frac{1}{\sqrt{x}} \quad \Rightarrow \quad g^2 = \frac{1}{x} \quad \Rightarrow \quad \frac{1}{g^2} = x
\]
因此问题转化为：找到 \( g \) 满足方程：
\[
\frac{1}{g^2} - x = 0
\]

## 2. 牛顿-拉夫逊方法
牛顿法用于求解 \( f(g) = 0 \)，迭代公式为：
\[
g_{n+1} = g_n - \frac{f(g_n)}{f'(g_n)}
\]
这里：
\[
f(g) = \frac{1}{g^2} - x = g^{-2} - x
\]
\[
f'(g) = -2 g^{-3}
\]

## 3. 代入迭代公式
\[
g_{n+1} = g_n - \frac{g_n^{-2} - x}{-2 g_n^{-3}}
\]

### 化简步骤：
\[
= g_n + \frac{g_n^{-2} - x}{2 g_n^{-3}}
\]
\[
= g_n + \frac{g_n^{3}(g_n^{-2} - x)}{2}
\]
\[
= g_n + \frac{g_n - g_n^3 x}{2}
\]
\[
= g_n + \frac{g_n}{2} - \frac{g_n^3 x}{2}
\]
\[
= \frac{3g_n}{2} - \frac{g_n^3 x}{2}
\]
\[
= \frac{g_n}{2}(3 - g_n^2 x)
\]

## 4. 最终迭代公式
所以，每次迭代更新为：
\[
g_{n+1} = \frac{g_n}{2} (3 - g_n^2 x)
\]

---

## 5. 关键理解点
- 这个迭代过程只需要**乘法和减法**，不需要除法或开方，适合早期计算机快速计算。
- 初始猜测 \( g_0 \) 需要比较接近真实值，否则可能收敛较慢或发散。
- 在著名的**快速逆平方根算法**（如《雷神之锤》中的 `0x5f3759df` 方法）中，会先用一个**魔数**进行位运算得到优秀的初始近似，再用 1-2 次牛顿迭代得到高精度结果。

### 几何理解：
函数 \( y = 1/g^2 - x \) 在 \( g > 0 \) 时是单调递减的，牛顿法从初始猜测开始，沿着切线逼近零点 \( g = 1/\sqrt{x} \)。

